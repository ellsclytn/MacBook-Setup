# freshshell.com
#
# Examples:
#
#   fresh twe4ked/dotfiles shell/functions/\*
#   fresh jasoncodes/dotfiles shell/aliases/rails.sh
#   fresh jasoncodes/dotfiles config/tmux.conf --file
#
# See http://freshshell.com/readme for documentation.

export GPG_KEY_ID="${GPG_KEY_ID:-DEF7E66A739ACB11}"

if [[ -x "$(command -v pacman)" ]]; then
  export OS="arch"
fi
if [[ -x "$(command -v apt-get)" ]]; then
  export OS="ubuntu"
fi
if [[ "$(uname)" == "Darwin" ]]; then
  export OS="macos"
fi

fresh freshshell/fresh bin/fresh --bin
fresh freshshell/fresh contrib/source-build.sh --file=~/.zshrc

# Shell
fresh-options
  fresh env/\*
  fresh robbyrussell/oh-my-zsh lib/history.zsh

  if [[ -x "$(command -v pacman)" ]]; then
    fresh env/arch/\*
  fi

  if [[ "$(uname)" == "Darwin" ]]; then
    fresh env/mac/\*
  fi

  if [[ "$(uname)" == "Linux" ]]; then
    fresh env/linux/\*
  fi

  fresh env/aliases.sh
fresh-options

# Secret Shell Stuff ðŸ¤«
# We can't do decryption operations on machines without a private key!
if gpg --list-secret-keys $GPG_KEY_ID 2>&1 >/dev/null; then
  fresh-options --filter="gpg -dq"
    if [[ "$(uname)" == "Darwin" ]]; then
      fresh env/secrets/mac.sh.gpg
    fi
  fresh-options
fi

# Alacritty
fresh alacritty/\*.yml --file=~/.config/alacritty/alacritty.yml --filter=gomplate

# Bin
fresh bin/\* --bin

if [[ -x "$(command -v pacman)" ]]; then
  fresh bin/arch/\* --bin
fi

# GPG
fresh gnupg/gpg.conf --file=~/.gnupg/gpg.conf
fresh gnupg/gpg-agent.conf --file=~/.gnupg/gpg-agent.conf --filter=gomplate

# Git
fresh git/\* --file

fresh-options --file=~/.gitignore_global --marker=#
  fresh github/gitignore Global/Vagrant.gitignore
  fresh github/gitignore Global/Vim.gitignore
  fresh github/gitignore Global/macOS.gitignore
  fresh github/gitignore Node.gitignore
  fresh git/gitignore
fresh-options

# Vim
fresh nvim/plugins/coc.json --file=~/.config/nvim/coc-settings.json
fresh nvim/plugs.vim --file=~/.config/nvim/init.vim
fresh-options --file=~/.config/nvim/init.vim
  fresh nvim/config/\*.vim
  fresh nvim/plugins/\*.vim
  fresh hackling/dotfiles vim/keybindings/visualblockindent.vim
fresh-options
fresh nvim/colors.vim --file=~/.config/nvim/init.vim

# i3wm, etc.
if [[ -x "$(command -v i3)" ]]; then
  fresh-options --file=~/.config/i3/config --marker=#
    fresh config/i3/\*
    fresh https://gitlab.com/JackCuthbert/dotfiles.git i3/keybindings/multimedia.conf
  fresh-options
  fresh config/rofi/\* --file=~/.config/rofi/config --marker=#
  fresh-options --file=~/.config/polybar/config --marker=";"
    fresh config/polybar/colors
    fresh config/polybar/config
    fresh config/polybar/bar
    if [[ -z ${LAPTOP+x} ]]; then
      fresh config/polybar/overrides/desktop/bar
    else
      fresh config/polybar/overrides/laptop/bar
    fi

    fresh config/polybar/modules/\*
  fresh-options

  fresh config/xinitrc --file

  # Compton
  fresh config/compton/\*.conf --file=~/.config/compton.conf

  # Rofi
  fresh config/Xresources --file --marker=!
fi
